<html>
<head>
    <title></title>
    <script src="./bower_components/threejs/build/three.js"></script>
    <script src="./bower_components/stats.js/build/stats.min.js"></script>
    <script src="./coastline.js"></script>
    <style>
    body {
        background: black;
        margin: 0;
        padding: 0;
    }
    #overlay {
        position: absolute;
        color: rgb(77, 255, 102);
        font-size: 3vh;
        font-family: courier;
        top: 38%;
        width: 100%;
        text-align: center;
        text-shadow: 0px 0px 10px rgb(77, 255, 102);
    }
    </style>
    <script id="texturedVert" type="x-shader/x-vertex">
        varying vec2 vUv;
        varying vec3 vNormal;

        void main() {
            vUv = uv;
            vNormal = vec3(modelViewMatrix * vec4(normal, 1.0));

            gl_Position =   projectionMatrix *
                            modelViewMatrix *
                            vec4(position,1.0);
        }
    </script>
    <script id="texturedFrag" type="x-shader/x-fragment">
        uniform sampler2D texture1;
        uniform float cutoff;
        varying vec2 vUv;
        varying vec3 vNormal;
        float trace = 0.008;
        float land_trace = 0.1;

        void main() {
            float norm_magnitude = length(vec2(vNormal));
            float edge_color =pow(norm_magnitude, 30.0) * 4.0;
            vec4 sample = texture2D(texture1, vUv);

            if (sample.r > cutoff + trace) {
                sample.rgb = vec3(0.0);
            } else if (sample.r > cutoff - trace) {
                float val = 1.0 - (sample.r - (cutoff - trace)) / (1.0 - (cutoff - trace))*50.0;
                sample.rgb = max(0.0, val) * vec3(0.3, 1.0, 0.4);
            } else {
                sample.rgb = vec3(0.0);
            }
            sample.rgb += edge_color * vec3(0.3, 1.0, 0.4);
            gl_FragColor = sample;
            //gl_FragColor = vec4(0.5, 0.2, 1.0, 1.0);
        }
    </script>
    <script type="x-shader/x-vertex" id="vert">
        uniform float time;

        // switch on high precision floats
        #ifdef GL_ES
        precision highp float;
        #endif

        #define DEG2RAD 2.0*3.14159/360.0;

        vec3 degToRad(vec3 p) {
            return p * DEG2RAD;
        }

        vec3 sphereToCartesian(vec3 p) {
            return vec3(sin(p.x) * cos(p.y),
                        sin(p.y),
                        cos(p.x) * cos(p.y));
        }

        void main()
        {
            vec3 q = degToRad(position);
            q.x += time;
            vec3 p = sphereToCartesian(q);
            // p.x += 2.0;
            p *= 50.0;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(p,1.0);
        }

    </script>
    <script type="x-shader/x-fragment" id="frag">
        uniform float time;
        #ifdef GL_ES
        precision highp float;
        #endif

        void main()
        {
            gl_FragColor = vec4(1.0,1.0,1.0,1.0);
        }

    </script>
</head>
<body>
<!-- <img src="./ocean_dist.png" /> -->
<div id="container"></div>
<div id="overlay">
    <p>45&deg;39'41.673" 5790m</p>
    <p>45&deg;39'41.673" 5790m</p>
    <p>45&deg;39'41.673" 5790m</p>
</div>
</body>
<script src="./main.js"></script>
</html>